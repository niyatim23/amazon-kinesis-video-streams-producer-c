<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Amazon Kinesis Producer C SDK: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Amazon Kinesis Producer C SDK
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 align="center">Amazon Kinesis Video Streams C Producer <br  />
 </h1>
<h4 align="center">Amazon Kinesis Video Streams | Secure Video Ingestion for Analysis &amp; Storage </h4>
<p align="center"></p>
<p><a href="https://travis-ci.org/awslabs/amazon-kinesis-video-streams-producer-c"><img src="https://travis-ci.org/awslabs/amazon-kinesis-video-streams-producer-c.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/> </a> <a href="https://codecov.io/gh/awslabs/amazon-kinesis-video-streams-producer-c"><img src="https://codecov.io/gh/awslabs/amazon-kinesis-video-streams-producer-c/branch/master/graph/badge.svg" alt="Coverage Status" style="pointer-events: none;" class="inline"/> </a> </p>
<p align="center"></p>
<p><a href="#key-features">Key Features</a> • <a href="#build">Build</a> • <a href="#run">Run</a> • <a href="#documentation">Documentation</a> • <a href="#related">Related</a> • <a href="#license">License</a> </p>
<h2><a class="anchor" id="autotoc_md0"></a>
Key Features</h2>
<p>Amazon Kinesis Video Streams Producer SDK for C/C++ makes it easy to build an on-device application that securely connects to a video stream, and reliably publishes video and other media data to Kinesis Video Streams. It takes care of all the underlying tasks required to package the frames and fragments generated by the device's media pipeline. The SDK also handles stream creation, token rotation for secure and uninterrupted streaming, processing acknowledgements returned by Kinesis Video Streams, and other tasks.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Build</h2>
<h3><a class="anchor" id="autotoc_md2"></a>
Download</h3>
<p>To download run the following command:</p>
<p><code>git clone --recursive <a href="https://github.com/awslabs/amazon-kinesis-video-streams-producer-c.git">https://github.com/awslabs/amazon-kinesis-video-streams-producer-c.git</a></code></p>
<p>Note: If you miss running git clone with &ndash;recursive, run <code>git submodule update --init</code> in the amazon-kinesis-video-streams-producer-c/open-source directory You will also need to install <code>pkg-config</code>, <code>automake</code> and <code>CMake</code> and a build enviroment</p>
<h3><a class="anchor" id="autotoc_md3"></a>
Configure</h3>
<p>Create a build directory in the newly checked out repository, and execute CMake from it.</p>
<p><code>mkdir -p amazon-kinesis-video-streams-producer-c/build; cd amazon-kinesis-video-streams-producer-c/build; cmake ..</code></p>
<p>By default we download all the libraries from GitHub and build them locally, so should require nothing to be installed ahead of time. If you do wish to link to existing libraries you can use the following flags to customize your build.</p>
<h4><a class="anchor" id="autotoc_md4"></a>
Cross-Compilation</h4>
<p>If you wish to cross-compile <code>CC</code> and <code>CXX</code> are respected when building the library and all its dependencies. See our <a href=".travis.yml">.travis.yml</a> for an example of this. Every commit is cross compiled to ensure that it continues to work.</p>
<h4><a class="anchor" id="autotoc_md5"></a>
CMake Arguments</h4>
<p>You can pass the following options to <code>cmake ..</code>.</p>
<ul>
<li><code>-DBUILD_DEPENDENCIES</code> &ndash; Whether or not to build depending libraries from source</li>
<li><code>-DBUILD_TEST=TRUE</code> &ndash; Build unit/integration tests, may be useful for confirm support for your device. <code>./tst/producer_test</code></li>
<li><code>-DCODE_COVERAGE</code> &ndash; Enable coverage reporting</li>
<li><code>-DCOMPILER_WARNINGS</code> &ndash; Enable all compiler warnings</li>
<li><code>-DADDRESS_SANITIZER</code> &ndash; Build with AddressSanitizer</li>
<li><code>-DMEMORY_SANITIZER</code> &ndash; Build with MemorySanitizer</li>
<li><code>-DTHREAD_SANITIZER</code> &ndash; Build with ThreadSanitizer</li>
<li><code>-DUNDEFINED_BEHAVIOR_SANITIZER</code> Build with UndefinedBehaviorSanitizer</li>
<li><code>-DALIGNED_MEMORY_MODEL</code> Build for aligned memory model only devices. Default is OFF.</li>
</ul>
<p>DMEMORY_SANITIZER, DTHREAD_SANITIZER etc. flags works only with clang compiler and not with gcc compiler. For using clang (on Ubuntu), do the following - </p><div class="fragment"><div class="line">sudo apt-get install clang</div>
<div class="line">export CC=/usr/bin/clang</div>
<div class="line">export CXX=/usr/bin/clang++</div>
<div class="line">cmake .. -DMEMORY_SANITIZER=TRUE</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md6"></a>
Build</h3>
<p>To build the library run make in the build directory you executed CMake.</p>
<p><code>make</code></p>
<h3><a class="anchor" id="autotoc_md7"></a>
Run samples</h3>
<p>To run the samples:</p>
<div class="fragment"><div class="line">export AWS_SECRET_ACCESS_KEY=&lt;YourAWSSecretAccessKey&gt;</div>
<div class="line">export AWS_ACCESS_KEY_ID=&lt;YourAWSAccessKey&gt;</div>
</div><!-- fragment --><p> For audio+video, run <code>./kvsAudioVideoStreamingSample &lt;channel-name&gt; &lt;streaming-duration-in-seconds&gt; &lt;sample-location&gt; &lt;audio-codec&gt;</code></p>
<p>The last three arguments are optional. By default,</p><ul>
<li>the <code>streaming-duration-in-seconds</code> is 20 seconds</li>
<li><code>sample-location</code> is <code>../samples</code></li>
<li><code>audio-codec</code> is <code>aac</code></li>
</ul>
<p>If you want to use the sample for <code>PCM_ALAW/G.711</code> frames, run <code>./kvsAudioVideoStreamingSample &lt;channel-name&gt; &lt;streaming_duration&gt; &lt;sample_location&gt; alaw 0</code></p>
<p>This will stream the video/audio files from the <code>samples/h264SampleFrames</code> and <code>samples/aacSampleFrames</code> or <code>samples/alawSampleFrames</code> (as per the choice of audio codec in the last argument) respectively.</p>
<p>If you want to enable KVS events in fragment metadata and automatically add an event on every key frame, add a 5th input. "notification" for a notification event. "image" for an image generation event. "both" for both. Otherwise leave it blank This feature is found only in the audio/video sample, but can be written into the video only sample as well.</p>
<p>For video only, run <code>./kvsVideoOnlyStreamingSample &lt;channel-name&gt;</code></p>
<p>This will stream the video files from the <code>samples/h264SampleFrames</code>.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Run unit tests</h3>
<p>Since these tests exercise networking you need to have AWS credentials specified, specifically you need to:</p>
<div class="fragment"><div class="line">export AWS_SECRET_ACCESS_KEY=&lt;YourAWSSecretAccessKey&gt;</div>
<div class="line">export AWS_ACCESS_KEY_ID=&lt;YourAWSAccessKey&gt;</div>
</div><!-- fragment --><p>Now you can execute the unit tests from the <code>build</code> directory as follows: <code>./tst/producer_test</code></p>
<h3><a class="anchor" id="autotoc_md9"></a>
Offline mode</h3>
<p>The samples run in near real time mode by default. In order to set up offline mode, the following APIs can be used in the samples instead of the realtime variant:</p>
<p>For video only: <code><a class="el" href="group__PublicMemberFunctions.html#ga6e083dfc57516c4efaa9951df09c6848">createOfflineVideoStreamInfoProviderWithCodecs()</a></code> For video and audio: <code><a class="el" href="group__PublicMemberFunctions.html#ga70f651dfddea8ff8e60c89571204be15">createOfflineAudioVideoStreamInfoProviderWithCodecs()</a></code></p>
<p>The 2 APIs are available in <a href="https://github.com/awslabs/amazon-kinesis-video-streams-producer-c/blob/412aab82c99a72f9dbde975f5fea81ffdc844ae5/src/include/com/amazonaws/kinesis/video/cproducer/Include.h">this</a> header file.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Development</h2>
<p>The repository is using <code>develop</code> branch as the aggregation and all of the feature development is done in appropriate feature branches. The PRs (Pull Requests) are cut on a feature branch and once approved with all the checks passed they can be merged by a click of a button on the PR tool. The master branch should always be build-able and all the tests should be passing. We are welcoming any contribution to the code base. The master branch contains our most recent release cycle from <code>develop</code>.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Release</h3>
<p>The repository is under active development and even with incremental unit test coverage where some of the tests are actually full integration tests, we require more rigorous internal testing in order to 'cut' release versions. The release is cut against a particular commit that gets approved. The general philosophy is to cut a release when a set of commits contribute to a self-containing feature or when we add major internal functionality improvements.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
Versioning</h3>
<p>We deploy 3 digit version strings in a form of 'Major.Minor.Revision' scheme.</p><ul>
<li>Major version update - Major functionality changes. Might not have direct backward compatibility. For example, multiple public API parameter changes.</li>
<li>Minor version update - Additional features. Major bug fixes. Might have some minor backward compatibility issues. For example, an extra parameter on a callback function.</li>
<li>Revision version update - Minor features. Bug fixes. Full backward compatibility. For example, an extra fields added to the public structures with version bump.</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
Documentation</h2>
<h2><a class="anchor" id="autotoc_md14"></a>
Related</h2>
<ul>
<li><a href="https://github.com/awslabs/amazon-kinesis-video-streams-producer-sdk-cpp/">CPP SDK</a></li>
<li><a href="https://github.com/awslabs/amazon-kinesis-video-streams-producer-sdk-java/">Java SDK</a></li>
<li><a href="https://github.com/awslabs/amazon-kinesis-video-streams-pic/">PIC</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md15"></a>
License</h2>
<p>This library is licensed under the Apache 2.0 License. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Feb 8 2023 18:56:34 for Amazon Kinesis Producer C SDK by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
